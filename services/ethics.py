import re

def is_ethical_request(text: str) -> bool:
    """
    ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง ูุชู ุฏุฑุฎูุงุณุช ุงุฒ ฺฉุงุฑุจุฑ ุญุงู ูุญุชูุง ุบุฑูุงูููุ ุขุณุจโุฒููุฏู ุง ุบุฑุงุฎูุงู ุงุณุช.
    ุจุงุฒฺฏุดุช True = ุฏุฑุฎูุงุณุช ุงุฎูุงู ู ูุงุจู ูพุฑุฏุงุฒุด.
    ุจุงุฒฺฏุดุช False = ุฏุฑุฎูุงุณุช ุจุงุฏ ุฑุฏ ุดูุฏ.
    """
    if not text or not isinstance(text, str):
        return False

    text = text.lower().strip()

    # ๐ ุงูฺฏููุง ุบุฑูุงููู / ุฎุทุฑูุงฺฉ (ุญุณุงุณ ุจู ุฒุจุงู ูุงุฑุณ ู ุงูฺฏูุณ)
    unethical_patterns = [
        # ฺฉูุงูุจุฑุฏุงุฑุ ูุดูฺฏุ ุฏุฒุฏ
        r"\b(hack|phishing|scam|fake|trick|ุฏุฒุฏ|ุณุฑูุช|ฺฉูุงู|ูุด|ฺฉูุงูุจุฑุฏุงุฑ|ุฏุฑูุบ|ูุฑุจ|ูุฑูุด ุณุงูุท)\b",
        
        # ุขุณุจโุฑุณุงูุ ุชูุฏุฏุ ุฎุดููุช
        r"\b(doxx?|swat|attack|threat|harass|ุขุฒุงุฑ|ุชูุฏุฏ|ุขุณุจ|ุฎุดููุช|ุฌูฺฏ|ฺฉุดุชู|ุชุฑูุฑ)\b",
        
        # ุฏูุฑ ุฒุฏู ุณุณุชูุ ูฺฉุ ุบุฑูุงููู
        r"\b(bypass|crack|exploit|illegal|ุบุฑูุงููู|ููุชุฑุดฺฉู|ุฏูุฑ ุฒุฏู|ุฎุฑุงุจฺฉุงุฑ|ูฺฉ|ูุฑูุฏ ุบุฑูุฌุงุฒ|ุจุฏุงูุฒุงุฑ)\b",
        
        # ููุงุฏ ูุฎุฏุฑุ ุณูุงุญุ ููุงุฑ
        r"\b(drug|weapon|bomb|ููุงุฑ|ูุฎุฏุฑ|ุณูุงุญ|ุงููุฌุงุฑ|ุชุฑูุฑุณุช|ุดุจุญ|ฺฉุฑูพุชู ุงุณฺฉู)\b",
        
        # ุญููุงุช ูู (ุฌููฺฏุฑ ุงุฒ SQLi, XSS, etc.)
        r"(union\s+select|select\s+\*|drop\s+table|--|<script|javascript:|onload\s*=|\.exe|\.bat)",
    ]

    for pattern in unethical_patterns:
        if re.search(pattern, text, re.IGNORECASE):
            return False

    return True


def get_ethics_rejection_message(lang: str = "fa") -> str:
    """
    ูพุงู ุงุณุชุงูุฏุงุฑุฏ ุจุฑุง ุฑุฏ ุฏุฑุฎูุงุณุชโูุง ุบุฑุงุฎูุงู โ ุจู ฺูุฏ ุฒุจุงู.
    """
    messages = {
        "fa": (
            "โ๏ธ **ุฏุฑุฎูุงุณุช ุดูุง ูพุฑุฏุงุฒุด ููโุดูุฏ.**\n"
            "ูู ฺฉ ุฑุจุงุช ููุดููุฏ ูุณุชู ฺฉู **ุตุฑูุงู ุฏุฑ ุฎุฏูุช ุขฺฏุงูุ ุงุฏฺฏุฑ ู ุนุฏุงูุช** ุงุณุช.\n"
            "ูฺโฺฏุงู ุฏุฑ ูุนุงูุชโูุง ุบุฑูุงูููุ ฺฉูุงูุจุฑุฏุงุฑุ ุขุณุจโุฑุณุงู ุง ุฏูุฑ ุฒุฏู ุงููุช ฺฉูฺฉ ููโฺฉูู.\n"
            "ุงฺฏุฑ ุณุคุงู ุฏุฑุจุงุฑูู ุขููุฒุดุ ุชุญูู ุจุงุฒุงุฑุ ุญููู ุง ููุณูุฏฺฏ ุฏุงุฑุ ุฎูุดุญุงู ูโุดู ฺฉูฺฉ ฺฉูู."
        ),
        "en": (
            "โ๏ธ **Your request cannot be processed.**\n"
            "I am an AI assistant dedicated **only to knowledge, justice, and learning**.\n"
            "I do not assist with fraud, harm, illegal acts, or bypassing security.\n"
            "If you have questions about education, market analysis, legal writing, or research, Iโd be glad to help."
        ),
        "ar": (
            "โ๏ธ **ูุง ูููู ูุนุงูุฌุฉ ุทูุจู.**\n"
            "ุฃูุง ูุณุงุนุฏ ุฐูู ูุฎุตุต **ูููุนุฑูุฉ ูุงูุนุฏุงูุฉ ูุงูุชุนูู ููุท**.\n"
            "ูุง ุฃุณุงุนุฏ ูู ุงูุงุญุชูุงู ุฃู ุงูุฅูุฐุงุก ุฃู ุงูุฃูุดุทุฉ ุบูุฑ ุงููุงููููุฉ ุฃู ุชุฌุงูุฒ ุงูุฃูุงู.\n"
            "ุฅุฐุง ูุงูุช ูุฏูู ุฃุณุฆูุฉ ุญูู ุงูุชุนููู ุฃู ุชุญููู ุงูุณูู ุฃู ุงููุชุงุจุฉ ุงููุงููููุฉ ุฃู ุงูุจุญุซุ ูุณุฃููู ุณุนูุฏูุง ุจูุณุงุนุฏุชู."
        )
    }
    return messages.get(lang, messages["fa"])
